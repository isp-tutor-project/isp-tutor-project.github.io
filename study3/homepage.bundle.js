!function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){"use strict";r.r(t);r(0),r(1);r(2);class i{constructor(){}setCredentials(e,t){this.classCode=e,this.userID=t}getUserData(){}getActivityData(e,t=!0){}getRQData(){}getCurrHypoTask(){}getInitialHypoData(){}getFinalHypoData(){}saveValue(e,t){}saveJSONValue(e,t){}getBoolValue(e){}getIntValue(e){}getFloatValue(e){}getTextValue(e){}getJSONValue(e){}}class n extends i{constructor(){super()}setCredentials(e,t){super.setCredentials(e,t)}getUserData(){console.count("getUserData() called");let e={};return Promise.all([this.getTextValue("classCode"),this.getTextValue("userID"),this.getActivityData("rqted"),this.getCurrHypoTask(),this.getIntialHypoData(),this.getFinalHypoData()]).then(([t,r,i,n,a,s])=>(e.classCode=t,e.userID=r,e.rqted=i,n&&(e.currHypoTaskIdx=n),a&&(e.firstPrediction=a.firstPrediction,e.initialHypo=a.initialHypo),s&&(e.secondPrediction=s.secondPrediction,e.finalHypo=s.finalHypo),e))}getActivityData(e,t=!0){return this.getJSONValue(e).then(e=>e&&t?JSON.parse(e):e)}getRQData(){let e=null;return this.getActivityData("rqted").then(t=>(e=t||{moduleState:{selectedArea:{index:1},selectedTopic:{index:1},selectedVariable:{index:1},selectedRQ:{index:1}}},e)).catch(t=>(console.error(t),e))}getCurrHypoTask(){return this.getIntValue("currHypoTaskIdx")}getIntialHypoData(){let e={};return this.getTextValue("firstPrediction").then(t=>null!==t?(e.firstPrediction=t,this.getJSONValue("initialHypo")):(e.firstPrediction=null,null)).then(t=>(e.initialHypo=t,e)).catch(t=>(console.error(t),e))}getFinalHypoData(){let e={};return this.getTextValue("secondPrediction").then(t=>null!==t?(e.secondPrediction=t,this.getJSONValue("finalHypo")):(e.secondPrediction=null,null)).then(t=>(e.finalHypo=t,e)).catch(t=>(console.error(t),e))}setValues(e,t=!1){return new Promise((t,r)=>{try{for(let[t,r]of Object.items(e))localStorage.setItem(t,r);t(!0)}catch(e){r(e)}})}saveValue(e,t){return new Promise((r,i)=>{try{r(localStorage.setItem(e,t))}catch(e){i(e)}})}saveJSONValue(e,t){return new Promise((r,i)=>{try{let i=JSON.stringify(t);r(localStorage.setItem(e,i))}catch(e){i(e)}})}getBoolValue(e){return new Promise((t,r)=>{try{let r=localStorage.getItem(e);void 0===r&&t(r),t("true"===r)}catch(e){r(e)}})}getIntValue(e){let t;return new Promise((r,i)=>{try{let i=localStorage.getItem(e);i&&(t=parseInt(i,10)),r(t)}catch(e){i(e)}})}getFloatValue(e){let t;return new Promise((r,i)=>{try{let i=localStorage.getItem(e);i&&(t=parseFloat(i)),r(t)}catch(e){i(e)}})}getTextValue(e){let t;return new Promise((r,i)=>{try{let i=localStorage.getItem(e);i&&(t=i),r(i)}catch(e){i(e)}})}getJSONValue(e){return new Promise((t,r)=>{try{let r=localStorage.getItem(e);r&&(r=JSON.parse(r)),t(r)}catch(e){r(e)}})}}const a={apiKey:"AIzaSyD7zIk-8V20QqJNSs0cAV0uNL3qjeqLMdM",authDomain:"isptutor.firebaseapp.com",projectId:"isptutor"};class s extends i{constructor(){super(),firebase.initializeApp(a),this.store=firebase.firestore()}setCredentials(e,t){super.setCredentials(e,t),this.userRef=this.store.collection(this.classCode).doc(this.userID)}getUserData(){return this.userRef.get().then(e=>e.exists?e.data:null)}getCurrHypoTask(){}getActivityData(e,t=!0){return this.getUserData().then(r=>{let i=r[e];return i&&t?JSON.parse(i):i})}setValues(e,t=!1){return this.userRef.set(e,{merge:!t})}updateValues(e){return this.userRef.update(e)}deleteValue(e){return this.userRef.update({[e]:firebase.firestore.FieldValue.delete()})}}const o=[{label:"Data Interpretation PreTest",phase:"pre-training",storageInfo:{currentActivity:"diPreTest"},url:"/apps/di-prepost/pretest.html",implemented:!0},{label:"Research Question Selection (Baseline)",phase:"rqSelect",storageInfo:{currentActivity:"rqSelect",currentActivityFeatures:"FTR_WEB:FTR_BASELINE:FTR_NCPLANTS"},url:"/tutors/rqSelect.html",implemented:!1},{label:"Research Question Selection (No Choice Crystal)",phase:"rqSelect",storageInfo:{currentActivity:"rqSelect",currentActivityFeatures:"FTR_WEB:FTR_NOCHOICE:FTR_NCCRYSTAL"},url:"/tutors/rqSelect.html",implemented:!1},{label:"Research Question Selection (Choice)",phase:"rqSelect",storageInfo:{currentModule:"rqSelect",currentActivityFeatures:"FTR_WEB:FTR_CHOICE"},url:"/tutors/rqSelect.html",implemented:!1},{label:"Hypothesis (definition pages only)",phase:"reference",storageInfo:{currentActivity:"hypoDefs",currentActivityFeatures:"FTR_WEB:FTR_DEFS_ONLY"},url:"/apps/hypo-gr/",implemented:!1},{label:"Hypothesis (Initial Hypo w/o CptMap)",phase:"hypo",storageInfo:{currentActivity:"initialHypo",currentActivityFeatures:"FTR_WEB:FTR_INITIAL_HYP:FTR_NOCPTMAP"},url:"/apps/hypo-gr/",implemented:!1},{label:"Hypothesis (Initial Hypo with CptMap)",phase:"hypo",storageInfo:{currentActivity:"initialHypo",currentActivityFeatures:"FTR_WEB:FTR_INITIAL_HYP"},url:"/apps/hypo-gr/",implemented:!1},{label:"Hypothesis (Initial Hypo Bi-Directional)",phase:"hypo",storageInfo:{currentActivity:"initialHypo",currentActivityFeatures:"FTR_WEB:FTR_INITIAL_HYP:FTR_BI_DIR"},url:"/apps/hypo-gr/",implemented:!1},{label:"Hypothesis (final hypothesis)",phase:"hypo",storageInfo:{currentActivity:"finalHypo",currentActivityFeatures:"FTR_WEB:FTR_FINAL_HYP:FTR_NO_DEFS"},url:"/apps/hypo-gr/",implemented:!1},{label:"Hypothesis WE (one-directional)",phase:"hypo",storageInfo:{currentActivity:"hypoWE",currentActivityFeatures:"FTR_ONE_DIRECTIONAL"},url:"/apps/hypo-we/",implemented:!1},{label:"Hypothesis WE (bi-directional)",phase:"hypo",storageInfo:{currentActivity:"hypoWE",currentActivityFeatures:"FTR_BI_DIRECTIONAL"},url:"/apps/hypo-we/",implemented:!1},{label:"Data Interpretation Instruction",phase:"data-interpretation",storageInfo:{currentActivity:"diInstruction"},url:"/apps/di-instr/",implemented:!0},{label:"Data Interpretation PostTest",phase:"post-training",storageInfo:{currentActivity:"diPostTest"},url:"/apps/di-prepost/posttest.html",implemented:!0}];function l(e){return document.getElementById(e)}function c(e){for(let t of document.querySelectorAll(".page"))t.id===e?t.classList.add("active"):t.classList.remove("active")}function u(e){let t=e.target.getAttribute("data-url"),r=e.target.getAttribute("data-activity"),i=e.target.getAttribute("data-activity-features");console.log(`\n    hovering over: ${e.target}\n    url: ${t}\n    currentActivity: ${r}\n    currentActivityFeatures: ${i}\n    `)}function d(e){e.preventDefault();let t=e.target.getAttribute("data-url"),r=e.target.getAttribute("data-activity"),i=e.target.getAttribute("data-activity-features");localStorage.setItem("currentActivity",r),localStorage.setItem("currentActivityFeatures",i),window.location.href=t}function p(e){e&&e.preventDefault(),c("index_page")}function g(e){e&&e.preventDefault(),c("home_page"),f.displayUser(y),F.innerHTML="",o.forEach(e=>{if(e.implemented){let t=document.createElement("p"),r=document.createElement("button");r.classList.add("activity-button"),r.classList.add("btn"),r.type="button",r.innerHTML=e.label,r.setAttribute("data-activity-features",e.storageInfo.currentActivityFeatures||""),r.setAttribute("data-activity",e.storageInfo.currentActivity),r.setAttribute("data-url",e.url),r.addEventListener("click",d),r.addEventListener("mouseover",u),t.appendChild(r),F.appendChild(t)}})}let h,y;const f=new class{constructor(){this.el=document.querySelector("nav.navbar"),this.userInfoRegion=document.getElementById("user_info_region"),this.activityTitle=document.getElementById("activity_title"),this.activitySection=document.getElementById("activity_section"),this.signOutBtn=document.getElementById("sign_out_button"),this.signInText=document.getElementById("sign_in_text"),this.signOutUser=this.signOutUser.bind(this),this.signOutBtn.addEventListener("click",this.signOutUser)}signOutUser(e){this.userInfoRegion.classList.add("invisible"),localStorage.clear(),window.location.path="/"}displayActivityTitle(e){this.activityTitle.innerText=e}displayActivitySection(e){this.activitySection.innerText=e}displayUser(e){this.signInText.innerHTML="Welcome, "+e,this.userInfoRegion.classList.remove("invisible")}},m=new class{constructor(e){this.el=document.getElementById(e||"snackbar")}show(e){this.el.innerHTML=e,this.el.classList.add("show"),setTimeout(()=>{this.el.classList.remove("show")},3e3)}},v=l("login_button"),I=l("l-back-button"),b=l("login_form"),A=l("login_submit"),T=l("register_button"),_=l("r-back-button"),S=l("registration_form"),D=l("registration_submit"),F=l("activity_btns_container");function E(e,t){return 2===e.length||(m.show("Please enter exactly two letters for your "+t),!1)}function H(e,t){let r={};if(["classcode","fname","lname","bmonth","bday"].forEach(t=>r[t]=`${e}_${t}`),!t.reportValidity())return!1;h=l(r.classcode).value.toUpperCase();let i=l(r.fname).value,n=l(r.lname).value,a=l(r.bmonth).value,s=l(r.bday).value;return!!E(i,"first name")&&(!!E(n,"last name")&&(y=i+n,!(!/^[A-Za-z]+$/.test(y)&&(m.show("Please do not enter any numbers, spaces, or special characters in your input."),1))&&(y+="_"+a+"_"+s,y=y.toUpperCase(),localStorage.setItem("classCode",h),localStorage.setItem("userID",y),!0)))}v.addEventListener("click",(function(e){e&&e.preventDefault(),c("login_page"),b.reset()})),T.addEventListener("click",(function(e){e&&e.preventDefault(),c("registration_page"),S.reset()})),I.addEventListener("click",p),_.addEventListener("click",p),A.addEventListener("click",e=>{e.preventDefault(),H("login",b)&&(db.setCredentials(h,y),db.getUserData().then(e=>{e?(console.log("Account found"),m.show("Signed in as "+y+"."),g()):(console.log("No such account!"),m.show("No such account exists. Check that your name and birthday were typed in correctly."))}).catch((function(e){console.log("Error getting account:",e),m.show("No such account exists. Check that you typed in the classcode correctly.")})))}),D.addEventListener("click",e=>{e.preventDefault(),H("register",S)&&(db.setCredentials(h,y),db.getUserData().then(e=>{e?(console.log("Account already exists"),m.show("Account already exists.")):(console.log("Creating account"),db.setValues({classCode:h,userID:y}).then((function(){console.log("Document successfully written!"),m.show("Signed in as "+y+"."),g()})).catch((function(e){console.error("Error writing document: ",e),m.show("Error creating new account.")})))}).catch((function(e){console.log("Error getting account:",e),m.show("Cannot create account. Please make sure that class code is correct.")})))}),null===localStorage.getItem("homepage")&&localStorage.setItem("homepage",window.location.href),window.db=function(e){let t;switch(e){case"firestore":t=new s;break;default:t=new n}return t}("localstorage"),h=localStorage.getItem("classCode"),y=localStorage.getItem("userID"),h&&y?g():p()}]);
//# sourceMappingURL=homepage.bundle.js.map